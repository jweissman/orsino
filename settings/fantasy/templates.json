{
  "pc": {
    "gender": "=oneOf(male, female, neutral)",
    "race": "=oneOf(human, orc, elf, dwarf, halfling, gnome, fae)",
    "class": "=oneOf(warrior, mage, thief, cleric, bard, ranger)",
    "age": "=16 + 2d20 + if(#race == \"elf\", 100, if(#race == \"dwarf\", 50, 0))",
    "_surname": "=lookup(surname, #class)",
    "forename": "=lookup(name, #gender)",
    "name": "=#forename + \" \" + #_surname",
    "str": "=3+3d6+if(#class == \"warrior\", 2, 0)",
    "dex": "=3+3d6+if(#class == \"thief\", 2, 0)",
    "int": "=3+3d6+if(#class == \"mage\", 2, 0)",
    "wis": "=3+3d6+if(#class == \"cleric\", 2, 0)",
    "cha": "=3+3d6+if(#class == \"bard\", 2, 0)",
    "con": "=3+3d6+if(#class == \"ranger\", 2, 0)",
    "maxHp": "=lookup(hitPoints, #class) + max(1,round((#con-10)/2))",
    "hp": "=#maxHp",
    "level": 1,
    "xp": 0,
    "weapon": "=oneOf(lookup(weapon, #class))",
    "damageDie": "=lookup(damageDie, #weapon)",
    "attackRolls": "=lookup(attackRolls, #weapon)",
    "armor": "=lookup(armor, #class)",
    "ac": "=10 + lookup(armorClassBonus, #armor) + floor((#dex-10)/2)",
    "gp": "=1d100",
    "spellSlots": "=if(#class == 'mage', 3, if(#class == 'cleric', 2, if(#class == 'bard', 2, 0)))"
  },
  "monster": {
    "_terrain": "=oneOf(forest, cave, swamp, mountain, snow, desert)",
    "race": "=oneOf(goblin, kobold, orc, human, ogre, troll, dragon)",
    "type": "=lookup(monsterType, #race)",
    "forename": "=lookup(monsterName, #race)",
    "_class": "=capitalize(#_terrain) + \" \" + capitalize(#race) + \" \" + #type",
    "name": "=#forename + \", \" + #_class",
    "_baseHp": "=lookup(monsterBaseHp, #race)",
    "_hpVariance": "=lookup(monsterHpVariance, #race)",
    "maxHp": "=#_baseHp + round(rand()*#_hpVariance)",
    "level": "=lookup(monsterLevel, #race)",
    "str": "=lookup(monsterStr, #race)",
    "dex": "=lookup(monsterDex, #race)",
    "con": "=lookup(monsterCon, #race)",
    "int": "=lookup(monsterInt, #race)",
    "wis": "=lookup(monsterWis, #race)",
    "cha": "=lookup(monsterCha, #race)",
    "_naturalArmor": "=lookup(monsterNaturalArmor, #race)",
    "ac": "=10 + #_naturalArmor + floor((#dex-10)/2)",
    "weapon": "=if(#type == 'slinger', 'sling', lookup(monsterWeapon, #race))",
    "damageDie": "=lookup(damageDie, #weapon)",
    "attackRolls": "=lookup(attackRolls, #weapon)",
    "_damageBonus": "=floor((#str-10)/2)",
    "xp": "=lookup(monsterXp, #race)",
    "gp": "=lookup(monsterGold, #race)",

    "*terrainModifier": "=lookup(monsterTerrainModifier, #_terrain)",
    "*typeModifier": "=lookup(monsterTypeModifier, #type)",
    "hp": "=#maxHp"
  },
  "encounter": {
    "_monsterCount": "=2+1d4",
    "monsters": "=genList(monster, #_monsterCount, \"=round(sum(#__items, 'level')) <= #targetCr\")",
    "bonusGold": "=2d20 + 5 * count(#monsters)",
    "cr": "=round(sum(#monsters, \"level\"))"
  },
  "room": {
    "_roomBias": "=lookup(roomBias, 'temple')",
    "room_type": "=pick(#_roomBias)",
    "narrative": "=lookup(roomNarrative, #room_type)",
    "room_size": "=oneOf(small, medium, large)",
    "_encounterChance": "=1",
    "_treasureChance": "=if(#room_type == \"treasury\", 1.0, oneOf(0.5, 0.8))",
    "targetCr": "=#_targetCr + round(#_index / 2)",
    "encounter": "=if(rand() < #_encounterChance, gen(encounter), nihil)",
    "treasure": "=if(rand() < #_treasureChance, lookup(treasure, oneOf(negligible, minor)), nihil)",
    "feature": "=lookup(roomFeature, 1d100)"
  },
  "boss_room": {
    "narrative": "=lookup(roomNarrative, oneOf(throne_room, lair, altar))",
    "size": "=oneOf(medium, large)",
    "targetCr": "=#_targetCr + round(#depth/2) + 2",
    "_monsterCount": "=3+1d4",
    "treasure": "=lookup(treasure, oneOf(major, legendary))",
    "type": "=lookup(bossMonsterType, #race)",
    "boss_encounter": "=gen(encounter)"
  },
  "dungeon": {
    "_targetCr": "=1",
    "_building_type": "=oneOf(temple, fortress, library, tomb, mine)",
    "_roomBias": "=lookup(roomBias, #_building_type)",
    "dungeon_type": "=oneOf(cave, cave, castle, fane, tower, crypt, ruin)",
    "race": "=if(#_targetCr <= 3, oneOf(goblin, kobold), if(#_targetCr <= 6, oneOf(orc, human), if(#_targetCr <= 10, oneOf(ogre, troll), oneOf(dragon))))",
    "theme": "=oneOf(pain, power, darkness, nature, fire, ice, shadow, light, chaos, order, water, air, earth, lightning, death, life, time, mystery)",
    "aspect": "=oneOf(militarized, dreadful, ancient, cursed, hidden, forgotten, lost, sacred, profane, forbidden, haunted, mythical)",
    "dungeon_name": "=capitalize(#aspect) + \" \" + capitalize(#race) + \" \" + capitalize(#dungeon_type) + \" of \" + capitalize(#theme)",
    "depth": "=3+1d6",
    "rooms": "=genList(room, #depth)",
    "bossRoom": "=gen(boss_room)"
  }
}