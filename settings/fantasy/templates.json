{
  "pc": {
    "gender": "=oneOf(male, female, neutral)",
    "race": "=oneOf(human, orc, elf, dwarf, halfling, gnome, fae)",
    "class": "=oneOf(warrior, mage, thief, cleric, bard, ranger, sage)",
    "age": "=16 + 2d20 + if(#race == \"elf\", 100, if(#race == \"dwarf\", 50, 0))",
    "_surname": "=lookup(surname, #class)",
    "forename": "=lookup(name, #gender)",
    "name": "=#forename + \" \" + #_surname",
    "str": "=3d6+if(#class == \"warrior\", 3, 0)",
    "dex": "=3d6+if(#class == \"thief\", 3, 0)",
    "int": "=3d6+if(#class == \"mage\", 3, 0)",
    "wis": "=3d6+if(#class == \"cleric\", 3, 0)",
    "cha": "=3d6+if(#class == \"bard\", 3, 0)",
    "con": "=3d6+if(#class == \"ranger\", 3, 0)",
    "maxHp": "=lookup(hitPoints, #class) + max(1,round((#con-10)/2))",
    "hp": "=#maxHp",
    "level": 1,
    "xp": 0,
    "weapon": "=oneOf(lookup(weapon, #class))",
    "damageDie": "=lookup(damageDie, #weapon)",
    "attackRolls": "=lookup(attackRolls, #weapon)",
    "armor": "=lookup(armor, #class)",
    "ac": "=10 + lookup(armorClassBonus, #armor) + floor((#dex-10)/2)",
    "gp": "=1d100",
    "abilities": "=lookup(abilities, #class)"
  },
  "monster": {
    "terrain": "=oneOf(forest, cave, swamp, mountain, snow, desert)",
    "race": "=oneOf(goblin, kobold, orc, human, ogre, troll, dragon)",
    "type": "=lookup(monsterType, #race)",
    "forename": "=lookup(monsterName, #race)",
    "_class": "=capitalize(#terrain) + \" \" + capitalize(#race) + \" \" + #type",
    "name": "=#forename + \", \" + #_class",
    "level": "=lookup(monsterLevel, #race)",
    "_baseHp": "=lookup(monsterBaseHp, #race)",
    "_hpVariance": "=lookup(monsterHpVariance, #race)",
    "str": "=lookup(monsterStr, #race)",
    "dex": "=lookup(monsterDex, #race)",
    "con": "=lookup(monsterCon, #race)",
    "int": "=lookup(monsterInt, #race)",
    "wis": "=lookup(monsterWis, #race)",
    "cha": "=lookup(monsterCha, #race)",
    "maxHp": "=#_baseHp + round(rand()*#_hpVariance + #level / 2)",
    "_naturalArmor": "=lookup(monsterNaturalArmor, #race)",
    "armor": "=if(#level >= 5, 'plate', if(#level >= 3, 'chainmail', 'leather'))",
    "armorBonus": "=lookup(armorClassBonus, #armor)",
    "ac": "=10 + #_naturalArmor + floor((#dex-10)/2) + #armorBonus",
    "weapon": "=if(#type == 'slinger', 'sling', lookup(monsterWeapon, #race))",
    "damageDie": "=lookup(damageDie, #weapon)",
    "attackRolls": "=lookup(attackRolls, #weapon)",
    "xp": "=lookup(monsterXp, #race) * #level",
    "gp": "=lookup(monsterGold, #race)",
    "*terrainModifier": "=lookup(monsterTerrainModifier, #terrain)",
    "*typeModifier": "=lookup(monsterTypeModifier, #type)",
    "hp": "=#maxHp",
    "abilities": "=lookup(monsterAbilities, #type)"
  },
  "encounter": {
    "targetCr": "=#_targetCr",
    "terrain": "=oneOf(forest, cave, swamp, mountain, snow, desert)",
    "_monsterCount": "=2+1d4",
    "monsters": "=genList(monster, #_monsterCount, \"=round(sum(#__items, 'level')) <= #targetCr\")",
    "bonusGold": "=2d20 + 5 * count(#monsters)",
    "cr": "=round(sum(#monsters, \"level\"))"
  },
  "room": {
    "_targetCr": "1",
    "_index": "0",
    "_roomBias": "=lookup(roomBias, 'temple')",
    "room_type": "=pick(#_roomBias)",
    "narrative": "=lookup(roomNarrative, #room_type)",
    "room_size": "=oneOf(tiny, small, medium, large, enormous)",
    "_encounterChance": "=1",
    "_treasureChance": "=if(#room_type == \"treasury\", 1.0, oneOf(0.5, 0.8))",
    "targetCr": "=#_targetCr + round(#_index+1)",
    "encounter": "=if(rand() < #_encounterChance, gen(encounter), nihil)",
    "treasure": "=if(rand() < #_treasureChance, lookup(treasure, oneOf(negligible, minor)), nihil)",
    "feature": "=lookup(roomDecoration, 1d100)"
  },
  "boss_room": {
    "_targetCr": "1",
    "depth": "0",
    "race": "goblin",
    "room_type": "=oneOf(throne_room, lair, altar)",
    "narrative": "=lookup(roomNarrative, #room_type)",
    "room_size": "=oneOf(medium, large, enormous, huge, colossal)",
    "targetCr": "=#_targetCr + round(#depth) + 1",
    "_monsterCount": "=2+1d3",
    "treasure": "=lookup(treasure, oneOf(major, legendary))",
    "type": "=lookup(bossMonsterType, #race)",
    "boss_encounter": "=gen(encounter)",
    "feature": "=lookup(roomDecoration, 1d100)"
  },
  "dungeon": {
    "terrain": "=oneOf(forest, cave, swamp, mountain, snow, desert)",
    "_index": "0",
    "_targetCr": "=(#_index+1) * 2",
    "_building_type": "=oneOf(temple, fortress, library, tomb, mine)",
    "_roomBias": "=lookup(roomBias, #_building_type)",
    "dungeon_type": "=lookup(dungeonTypes, #_building_type)",
    "race": "=if(#_targetCr <= 3, oneOf(goblin, kobold), if(#_targetCr <= 6, oneOf(orc, human), if(#_targetCr <= 10, oneOf(ogre, troll), oneOf(dragon))))",
    "theme": "=oneOf(pain, power, darkness, nature, fire, ice, shadow, light, chaos, order, water, air, earth, lightning, death, life, time, mystery)",
    "aspect": "=lookup(dungeonAspect, #_building_type)",
    "dungeon_name": "=capitalize(#aspect) + \" \" + capitalize(#race) + \" \" + capitalize(#dungeon_type) + \" of \" + capitalize(#theme)",
    "depth": "=1+1d3",
    "dungeonIndex": "=#_index",
    "intendedCr": "=#_targetCr",
    "rooms": "=genList(room, #depth)",
    "bossRoom": "=gen(boss_room)",
    "direction": "=oneOf(north, south, east, west)",
    "rumor": "=eval(lookup(dungeonRumor, #_building_type))"
  },
  "town": {
    "terrain": "=lookup(terrains, 1d6)",
    "size": "=oneOf(hamlet, village, town, city, metropolis, capital)",
    "race":"=oneOf(human, elf, dwarf, halfling, gnome, fae)",
    "deity": "=oneOf(lookup(deity, #race))",
    "capital": "=#size == 'capital'",
    "population": "=eval(lookup(townPop, #size))",
    "_aspect": "=lookup(terrainFeatures, #terrain)",
    "_suffix": "=oneOf(ford, haven, burg, port, dale, keep, watch, gate, rest, fall, ridge, wood, field, pass, hold, stead, view, point, hill, bay, cliff, cross)",
    "name": "=capitalize(#_aspect + #_suffix)",
    "adjective": "=oneOf(peaceful, bustling, prosperous, decaying, ancient, vibrant, sleepy, lively, fair, grim, quaint, thriving, quiet, rustic, quaint, noble, humble, proud)"
  },
  "module": {
    "terrain": "=lookup(terrains, 1d6)",
    "town": "=gen(town)",
    "dungeons": "=genList(dungeon, 3+1d4)",
    "name": "=oneOf('Quest', 'Adventure', 'Saga') + ' in the ' + capitalize(#terrain)"
  }
}